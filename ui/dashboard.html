<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>STVOR Dashboard</title>
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    
    :root {
      --font-size-base: clamp(13px, 2vw, 14px);
      --font-size-h1: clamp(20px, 4vw, 28px);
      --font-size-h2: clamp(14px, 3vw, 18px);
      --padding-main: clamp(12px, 3vw, 32px);
      --gap-main: clamp(12px, 2vw, 20px);
      --border-radius: clamp(6px, 1.5vw, 12px);
    }
    
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: #0f172a;
      color: #e2e8f0;
      min-height: 100vh;
      font-size: var(--font-size-base);
      line-height: clamp(1.4, 0.3vw + 1.4, 1.6);
    }
    .layout { display: flex; min-height: 100vh; }
    
    .sidebar {
      width: clamp(180px, 18vw, 260px);
      background: #1e293b;
      padding: clamp(12px, 2vw, 24px);
      border-right: 1px solid #334155;
    }
    .logo {
      font-size: clamp(18px, 3vw, 24px);
      font-weight: 800;
      color: #fff;
      margin-bottom: clamp(4px, 1vw, 8px);
    }
    .logo span { color: #3b82f6; }
    .logo-sub { font-size: clamp(10px, 1.5vw, 12px); color: #64748b; margin-bottom: clamp(16px, 2vw, 32px); }
    
    .nav-item {
      display: flex;
      align-items: center;
      padding: clamp(8px, 1.5vw, 12px) clamp(10px, 2vw, 16px);
      border-radius: clamp(6px, 1vw, 8px);
      color: #94a3b8;
      text-decoration: none;
      margin-bottom: clamp(2px, 0.5vw, 4px);
      cursor: pointer;
      transition: all 0.2s;
      font-size: clamp(12px, 1.8vw, 14px);
    }
    .nav-item:hover, .nav-item.active {
      background: #334155;
      color: #fff;
    }
    .nav-item svg { margin-right: clamp(8px, 1.5vw, 12px); width: clamp(18px, 2vw, 20px); height: clamp(18px, 2vw, 20px); }
    
    .main { 
      flex: 1; 
      padding: clamp(12px, 3vw, 32px);
      max-width: 100%;
      overflow-y: auto;
    }
    
    .header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: clamp(16px, 3vw, 32px);
      flex-wrap: wrap;
      gap: var(--gap-main);
    }
    .header h1 { 
      font-size: var(--font-size-h1);
      font-weight: 700;
    }
    
    .plan-badge {
      display: inline-flex;
      align-items: center;
      padding: clamp(4px, 1vw, 6px) clamp(8px, 1.5vw, 12px);
      background: linear-gradient(135deg, #3b82f6 0%, #8b5cf6 100%);
      border-radius: clamp(16px, 2vw, 20px);
      font-size: clamp(10px, 1.5vw, 12px);
      font-weight: 600;
      color: white;
    }
    .plan-badge.free { background: linear-gradient(135deg, #059669 0%, #10b981 100%); }
    
    .btn {
      display: inline-flex;
      align-items: center;
      padding: clamp(8px, 1.5vw, 10px) clamp(12px, 2vw, 20px);
      font-size: clamp(12px, 1.8vw, 14px);
      font-weight: 600;
      border: none;
      border-radius: clamp(6px, 1vw, 8px);
      cursor: pointer;
      transition: all 0.2s;
      white-space: nowrap;
    }
    .btn-primary { background: #3b82f6; color: white; }
    .btn-primary:hover { background: #2563eb; }
    .btn-secondary { background: #334155; color: #e2e8f0; }
    .btn-secondary:hover { background: #475569; }
    .btn-danger { background: #dc2626; color: white; }
    .btn-danger:hover { background: #b91c1c; }
    
    .card {
      background: #1e293b;
      border: 1px solid #334155;
      border-radius: var(--border-radius);
      padding: clamp(12px, 2.5vw, 24px);
      margin-bottom: clamp(12px, 2vw, 24px);
    }
    .card h2 { 
      font-size: var(--font-size-h2);
      margin-bottom: clamp(10px, 2vw, 16px);
      color: #f8fafc;
    }
    .card h3 { 
      font-size: clamp(12px, 1.8vw, 14px);
      color: #94a3b8;
      margin-bottom: clamp(6px, 1.5vw, 8px);
      font-weight: 500;
    }
    
    .stats-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(clamp(150px, 25vw, 250px), 1fr));
      gap: var(--gap-main);
      margin-bottom: clamp(16px, 2vw, 24px);
    }
    .stat-card {
      background: linear-gradient(135deg, #1e293b 0%, #0f172a 100%);
      border: 1px solid #334155;
      border-radius: var(--border-radius);
      padding: clamp(12px, 2vw, 20px);
    }
    .stat-card h4 {
      font-size: clamp(10px, 1.5vw, 12px);
      color: #64748b;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      margin-bottom: clamp(6px, 1vw, 8px);
    }
    .stat-value {
      font-size: clamp(20px, 5vw, 32px);
      font-weight: 700;
      color: #f8fafc;
    }
    .stat-sub {
      font-size: clamp(11px, 1.5vw, 13px);
      color: #94a3b8;
      margin-top: clamp(2px, 0.5vw, 4px);
    }
    .stat-card.warning .stat-value { color: #fbbf24; }
    .stat-card.danger .stat-value { color: #ef4444; }
    .stat-card.success .stat-value { color: #10b981; }
    
    .progress-bar {
      height: clamp(6px, 1.5vw, 8px);
      background: #334155;
      border-radius: 4px;
      overflow: hidden;
      margin-top: clamp(8px, 1.5vw, 12px);
    }
    .progress-fill {
      height: 100%;
      background: linear-gradient(90deg, #3b82f6 0%, #8b5cf6 100%);
      border-radius: 4px;
      transition: width 0.3s ease;
    }
    .progress-fill.warning { background: linear-gradient(90deg, #f59e0b 0%, #fbbf24 100%); }
    .progress-fill.danger { background: linear-gradient(90deg, #dc2626 0%, #ef4444 100%); }
    
    .api-key-box {
      background: #0f172a;
      border: 1px solid #334155;
      border-radius: clamp(6px, 1vw, 8px);
      padding: clamp(10px, 2vw, 16px);
      display: flex;
      align-items: center;
      gap: clamp(8px, 1.5vw, 12px);
      margin: clamp(10px, 2vw, 16px) 0;
      flex-wrap: wrap;
    }
    .api-key-value {
      flex: 1;
      font-family: 'SF Mono', Monaco, monospace;
      font-size: clamp(11px, 1.8vw, 14px);
      color: #3b82f6;
      word-break: break-all;
      min-width: 150px;
    }
    .api-key-hidden {
      color: #64748b;
    }
    
    .copy-btn {
      background: #334155;
      color: #94a3b8;
      border: none;
      padding: clamp(6px, 1.2vw, 8px) clamp(10px, 1.8vw, 16px);
      border-radius: clamp(4px, 0.8vw, 6px);
      cursor: pointer;
      font-size: clamp(11px, 1.5vw, 13px);
      font-weight: 500;
      transition: all 0.2s;
      white-space: nowrap;
    }
    .copy-btn:hover { background: #475569; color: #fff; }
    .copy-btn.copied { background: #059669; color: #fff; }
    
    .project-list {
      margin-top: clamp(12px, 2vw, 16px);
    }
    .project-item {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: clamp(12px, 2vw, 16px);
      background: #0f172a;
      border: 1px solid #334155;
      border-radius: clamp(6px, 1.2vw, 8px);
      margin-bottom: clamp(6px, 1vw, 8px);
      flex-wrap: wrap;
      gap: var(--gap-main);
    }
    .project-name {
      font-weight: 600;
      color: #f8fafc;
      font-size: clamp(12px, 1.8vw, 14px);
    }
    .project-created {
      font-size: clamp(10px, 1.5vw, 12px);
      color: #64748b;
    }
    
    .modal-overlay {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.7);
      z-index: 1000;
      align-items: center;
      justify-content: center;
      padding: var(--gap-main);
    }
    .modal-overlay.active { display: flex; }
    .modal {
      background: #1e293b;
      border: 1px solid #334155;
      border-radius: var(--border-radius);
      padding: clamp(20px, 4vw, 32px);
      width: 100%;
      max-width: clamp(280px, 80vw, 480px);
    }
    .modal h2 { 
      margin-bottom: clamp(16px, 2vw, 24px);
      font-size: var(--font-size-h2);
    }
    .modal-input {
      width: 100%;
      padding: clamp(10px, 2vw, 12px) clamp(12px, 2vw, 16px);
      background: #0f172a;
      border: 1px solid #334155;
      border-radius: clamp(6px, 1vw, 8px);
      color: #e2e8f0;
      font-size: clamp(12px, 1.8vw, 14px);
      margin-bottom: clamp(12px, 2vw, 16px);
    }
    .modal-input:focus {
      outline: none;
      border-color: #3b82f6;
    }
    .modal-actions {
      display: flex;
      gap: clamp(8px, 1.5vw, 12px);
      justify-content: flex-end;
      flex-wrap: wrap;
    }
    
    .warning-banner {
      background: linear-gradient(135deg, #7c2d12 0%, #9a3412 100%);
      border: 1px solid #c2410c;
      border-radius: var(--border-radius);
      padding: clamp(12px, 2vw, 16px) clamp(14px, 2.5vw, 20px);
      display: flex;
      align-items: center;
      gap: clamp(10px, 2vw, 12px);
      margin-bottom: clamp(16px, 2vw, 24px);
    }
    .warning-banner .icon { font-size: clamp(18px, 3vw, 24px); }
    .warning-banner .text { 
      color: #fed7aa;
      font-size: clamp(12px, 1.8vw, 14px);
    }
    .warning-banner .text strong { color: #fff; }
    
    .success-banner {
      background: linear-gradient(135deg, #064e3b 0%, #065f46 100%);
      border: 1px solid #059669;
      border-radius: var(--border-radius);
      padding: clamp(12px, 2vw, 16px) clamp(14px, 2.5vw, 20px);
      display: flex;
      align-items: center;
      gap: clamp(10px, 2vw, 12px);
      margin-bottom: clamp(16px, 2vw, 24px);
    }
    .success-banner .icon { font-size: clamp(18px, 3vw, 24px); }
    .success-banner .text { 
      color: #a7f3d0;
      font-size: clamp(12px, 1.8vw, 14px);
    }
    .success-banner .text strong { color: #ecfdf5; }
    
    .upgrade-card {
      background: linear-gradient(135deg, #1e1b4b 0%, #312e81 100%);
      border: 1px solid #4f46e5;
    }
    .upgrade-card h2 { color: #c7d2fe; }
    .upgrade-features {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(clamp(120px, 40vw, 180px), 1fr));
      gap: clamp(8px, 1.5vw, 12px);
      margin: clamp(12px, 2vw, 16px) 0 clamp(16px, 2.5vw, 24px);
    }
    .upgrade-feature {
      display: flex;
      align-items: center;
      gap: clamp(6px, 1vw, 8px);
      color: #a5b4fc;
      font-size: clamp(11px, 1.5vw, 14px);
    }
    .upgrade-feature .check { color: #34d399; }

    /* ===== RESPONSIVE DESIGN ===== */
    
    /* Tablets 1024px and below */
    @media (max-width: 1024px) {
      .main {
        padding: 24px;
        max-width: 100%;
      }
      
      .header {
        flex-direction: column;
        align-items: flex-start;
        gap: 12px;
      }
      
      .stats-grid {
        grid-template-columns: repeat(2, 1fr);
        gap: 16px;
      }
      
      .stat-value {
        font-size: 24px;
      }
    }

    /* Tablets 768px and below */
    @media (max-width: 768px) {
      .sidebar {
        width: 200px;
        padding: 16px;
      }
      
      .logo {
        font-size: 20px;
        margin-bottom: 6px;
      }
      
      .logo-sub {
        font-size: 11px;
        margin-bottom: 16px;
      }
      
      .nav-item {
        padding: 10px 12px;
        font-size: 13px;
      }
      
      .nav-item svg {
        width: 18px;
        height: 18px;
      }
      
      .main {
        padding: 20px;
        max-width: 100%;
      }
      
      .header h1 {
        font-size: 24px;
      }
      
      .stats-grid {
        grid-template-columns: 1fr;
        gap: 16px;
      }
      
      .stat-value {
        font-size: 28px;
      }
      
      .card {
        padding: 16px;
        margin-bottom: 16px;
        border-radius: 8px;
      }
      
      .card h2 {
        font-size: 16px;
        margin-bottom: 12px;
      }
      
      .btn {
        padding: 8px 16px;
        font-size: 13px;
      }
      
      .upgrade-features {
        grid-template-columns: 1fr;
        gap: 8px;
      }
    }

    /* Mobile phones 480px and below */
    @media (max-width: 480px) {
      .layout {
        flex-direction: column;
      }
      
      .sidebar {
        position: fixed;
        left: -200px;
        top: 0;
        width: 200px;
        height: 100vh;
        z-index: 1000;
        transition: left 0.3s ease;
        box-shadow: 2px 0 10px rgba(0, 0, 0, 0.3);
        overflow-y: auto;
      }
      
      .sidebar.open {
        left: 0;
      }
      
      .main {
        padding: 12px;
        max-width: 100%;
        flex: 1;
      }
      
      .header {
        flex-direction: column;
        align-items: flex-start;
        gap: 8px;
        margin-bottom: 16px;
      }
      
      .header h1 {
        font-size: 20px;
        font-weight: 700;
      }
      
      .plan-badge {
        padding: 4px 8px;
        font-size: 11px;
      }
      
      .stats-grid {
        display: grid;
        grid-template-columns: 1fr;
        gap: 12px;
        margin-bottom: 16px;
      }
      
      .stat-card {
        padding: 12px;
        border-radius: 8px;
      }
      
      .stat-card h4 {
        font-size: 11px;
        margin-bottom: 4px;
      }
      
      .stat-value {
        font-size: 20px;
        font-weight: 700;
      }
      
      .stat-sub {
        font-size: 11px;
        margin-top: 2px;
      }
      
      .progress-bar {
        height: 6px;
        margin-top: 8px;
      }
      
      .card {
        background: #1e293b;
        border: 1px solid #334155;
        border-radius: 8px;
        padding: 12px;
        margin-bottom: 12px;
      }
      
      .card h2 {
        font-size: 14px;
        font-weight: 700;
        margin-bottom: 8px;
      }
      
      .card h3 {
        font-size: 12px;
        color: #94a3b8;
        margin-bottom: 6px;
      }
      
      .card p {
        font-size: 12px;
        color: #94a3b8;
        margin-bottom: 8px;
      }
      
      .btn {
        display: block;
        width: 100%;
        padding: 10px 12px;
        font-size: 12px;
        border: none;
        border-radius: 6px;
        cursor: pointer;
        transition: all 0.2s;
      }
      
      .btn-primary {
        background: #3b82f6;
        color: white;
        margin-bottom: 8px;
      }
      
      .btn-secondary {
        background: #334155;
        color: #e2e8f0;
        margin-bottom: 8px;
      }
      
      .btn-danger {
        background: #dc2626;
        color: white;
      }
      
      .api-key-box {
        padding: 10px;
        gap: 8px;
        margin: 8px 0;
      }
      
      .api-key-value {
        font-size: 11px;
      }
      
      .copy-btn {
        padding: 6px 10px;
        font-size: 11px;
      }
      
      .project-item {
        flex-direction: column;
        padding: 12px;
        gap: 8px;
      }
      
      .project-name {
        font-size: 13px;
      }
      
      .project-created {
        font-size: 11px;
      }
      
      .modal {
        width: 90%;
        padding: 20px;
      }
      
      .modal h2 {
        font-size: 16px;
        margin-bottom: 16px;
      }
      
      .modal-input {
        padding: 10px 12px;
        font-size: 13px;
        margin-bottom: 12px;
      }
      
      .modal-actions {
        gap: 8px;
      }
      
      .warning-banner {
        padding: 12px 14px;
        gap: 10px;
      }
      
      .warning-banner .icon {
        font-size: 18px;
      }
      
      .warning-banner .text {
        font-size: 12px;
      }
      
      .success-banner {
        padding: 12px 14px;
        gap: 10px;
      }
      
      .success-banner .icon {
        font-size: 18px;
      }
      
      .success-banner .text {
        font-size: 12px;
      }
      
      .upgrade-card {
        padding: 16px;
      }
      
      .upgrade-features {
        grid-template-columns: 1fr;
        gap: 8px;
      }
      
      .upgrade-feature {
        font-size: 12px;
      }
      
      /* Hide sidebar toggle for larger screens */
      .menu-toggle {
        display: none;
      }
    }

    /* Extra small phones 360px and below */
    @media (max-width: 360px) {
      .main {
        padding: 10px;
      }
      
      .header h1 {
        font-size: 18px;
      }
      
      .stat-value {
        font-size: 18px;
      }
      
      .card {
        padding: 10px;
        margin-bottom: 10px;
      }
      
      .card h2 {
        font-size: 13px;
      }
      
      .btn {
        padding: 8px 10px;
        font-size: 11px;
      }
      
      .modal {
        width: 95%;
        padding: 16px;
      }
      
      .api-key-box {
        flex-direction: column;
      }
      
      .copy-btn {
        width: 100%;
      }
    }
  </style>
</head>
<body>
  <div class="layout">
    
    <!-- SIDEBAR -->
    <nav class="sidebar">
      <div class="logo">STVOR<span>.</span></div>
      <div class="logo-sub">Dashboard v2.4.0</div>
      
      <a href="/" class="nav-item">
        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path></svg>
        Documentation
      </a>
      <a href="/dashboard.html" class="nav-item active">
        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"></path></svg>
        Dashboard
      </a>
      <a href="https://github.com/sapogeth/stvor_sdk" target="_blank" class="nav-item">
        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"></path></svg>
        GitHub
      </a>
    </nav>
    
    <!-- MAIN -->
    <main class="main">
      <div class="header">
        <h1>Dashboard</h1>
        <div class="plan-badge free">‚ú® v2.4.0 Production</div>
      </div>
      
      <!-- USAGE STATS -->
      <div class="stats-grid">
        <div class="stat-card" id="messages-stat">
          <h4>Messages This Month</h4>
          <div class="stat-value" id="messages-used">0</div>
          <div class="stat-sub">of <span id="messages-limit">1,000</span> messages</div>
          <div class="progress-bar">
            <div class="progress-fill" id="messages-progress" style="width: 0%"></div>
          </div>
        </div>
        
        <div class="stat-card success">
          <h4>Days Remaining</h4>
          <div class="stat-value" id="days-remaining">30</div>
          <div class="stat-sub">until limit reset</div>
        </div>
        
        <div class="stat-card">
          <h4>Registered Projects</h4>
          <div class="stat-value" id="projects-count">0</div>
          <div class="stat-sub">of 3 max (Free)</div>
        </div>
      </div>
      
      <!-- WARNING BANNER (hidden by default) -->
      <div class="warning-banner" id="limit-warning" style="display: none;">
        <span class="icon">‚ö†Ô∏è</span>
        <div class="text">
          <strong>Approaching message limit!</strong> You've used over 80% of your monthly quota.
        </div>
      </div>
      
      <!-- RELAY STATUS -->
      <div class="card" id="relay-status-card" style="border-color: #475569;">
        <div style="display: flex; align-items: center; justify-content: space-between;">
          <div style="display: flex; align-items: center; gap: 12px;">
            <span style="font-size: 20px;">üîå</span>
            <div>
              <h3 style="margin: 0; color: #f8fafc; font-weight: 600;">Relay Connection</h3>
              <p style="margin: 4px 0 0 0; color: #64748b; font-size: 13px;">
                Required for messaging to work
              </p>
            </div>
          </div>
          <div id="relay-status" style="display: flex; align-items: center; gap: 8px;">
            <span id="relay-status-dot" style="width: 10px; height: 10px; border-radius: 50%; background: #64748b;"></span>
            <span id="relay-status-text" style="color: #94a3b8; font-size: 14px;">Checking...</span>
          </div>
        </div>
      </div>
      
      <!-- ARCHITECTURE CLARITY -->
      <div class="card" style="background: linear-gradient(135deg, #f0f9ff 0%, #f8fafc 100%); border-color: #bfdbfe; border-left: 4px solid #3b82f6;">
        <div style="display: flex; align-items: flex-start; gap: 12px;">
          <span style="font-size: 24px;">üèóÔ∏è</span>
          <div>
            <h3 style="margin: 0 0 8px 0; color: #1e40af; font-weight: 600;">How This Works (v2.4)</h3>
            <p style="margin: 0 0 12px 0; color: #64748b; font-size: 14px; line-height: 1.6;">
              <strong>Three trusted roles:</strong>
            </p>
            <ul style="margin: 0; color: #64748b; font-size: 13px; line-height: 1.8; padding-left: 20px;">
              <li><strong>SDK (your client)</strong> ‚Äî Encrypts/decrypts. Never stores plaintext.</li>
              <li><strong>Backend (this server)</strong> ‚Äî Verifies crypto proofs, stores audit log.</li>
              <li><strong>Relay</strong> ‚Äî Routes encrypted messages (HTTP protocol, not WebSocket).</li>
              <li><strong>Dashboard</strong> ‚Äî Shows verified metrics only (read-only)</li>
            </ul>
            <p style="margin: 12px 0 0 0; color: #64748b; font-size: 13px;">
              ‚ö†Ô∏è <strong>The relay is untrusted</strong> ‚Äî it cannot decrypt messages or forge metrics.
            </p>
          </div>
        </div>
      </div>
      
      <!-- IMPORTANT: STORAGE ADAPTERS -->
      <div class="card" style="background: linear-gradient(135deg, #1e293b 0%, #0f172a 100%); border-color: #3b82f6; border-left: 4px solid #3b82f6;">
        <div style="display: flex; align-items: flex-start; gap: 12px;">
          <span style="font-size: 24px;">‚öôÔ∏è</span>
          <div>
            <h3 style="margin: 0 0 8px 0; color: #60a5fa; font-weight: 600;">v2.4: Storage Adapters Required (Prod)</h3>
            <p style="margin: 0 0 12px 0; color: #94a3b8; font-size: 14px; line-height: 1.6;">
              <strong style="color: #e2e8f0;">Production mode hard-fails without these:</strong>
            </p>
            <table style="width: 100%; border-collapse: collapse; font-size: 12px; color: #94a3b8; margin-bottom: 12px;">
              <tr style="border-bottom: 1px solid #334155;">
                <td style="padding: 6px; font-weight: 600;">Adapter</td>
                <td style="padding: 6px; font-weight: 600;">Purpose</td>
                <td style="padding: 6px; font-weight: 600;">Example</td>
              </tr>
              <tr style="border-bottom: 1px solid #334155;">
                <td style="padding: 6px;"><strong>ReplayCache</strong></td>
                <td style="padding: 6px;">Prevent replayed messages</td>
                <td style="padding: 6px;">Redis (5 min TTL)</td>
              </tr>
              <tr style="border-bottom: 1px solid #334155;">
                <td style="padding: 6px;"><strong>TofuStore</strong></td>
                <td style="padding: 6px;">Verify peer fingerprints</td>
                <td style="padding: 6px;">PostgreSQL</td>
              </tr>
              <tr style="border-bottom: 1px solid #334155;">
                <td style="padding: 6px;"><strong>SessionStore</strong></td>
                <td style="padding: 6px;">Persist encrypted state</td>
                <td style="padding: 6px;">PostgreSQL</td>
              </tr>
              <tr>
                <td style="padding: 6px;"><strong>IdentityStore</strong></td>
                <td style="padding: 6px;">Store identity keypair</td>
                <td style="padding: 6px;">OS Keychain / KMS</td>
              </tr>
            </table>
            <p style="margin: 0; color: #64748b; font-size: 13px;">
              ‚ö†Ô∏è <strong>Dev mode</strong> is optional and warns only. See docs for implementation examples.
            </p>
          </div>
        </div>
      </div>
      
      <!-- API KEYS -->
      <div class="card">
        <h2>üîë API Keys</h2>
        <p style="color: #94a3b8; margin-bottom: 16px;">Generate keys for your projects. Each key is unique and can be revoked anytime.</p>
        
        <div id="projects-list" class="project-list">
          <!-- Projects will be rendered here -->
        </div>
        
        <button class="btn btn-primary" onclick="openModal()" style="margin-top: 16px;">
          + Create New Project
        </button>
      </div>
      
      <!-- UPGRADE -->
      <div class="card upgrade-card">
        <h2>üöÄ Upgrade to Pro</h2>
        <p style="color: #a5b4fc;">Unlock unlimited messages and premium features.</p>
        
        <div class="upgrade-features">
          <div class="upgrade-feature"><span class="check">‚úì</span> Unlimited messages</div>
          <div class="upgrade-feature"><span class="check">‚úì</span> 10 projects</div>
          <div class="upgrade-feature"><span class="check">‚úì</span> Priority support</div>
          <div class="upgrade-feature"><span class="check">‚úì</span> Custom relay server</div>
        </div>
        
        <button class="btn" style="background: #6366f1; color: white;">
          Upgrade ‚Äî $29/mo
        </button>
      </div>
      
      <!-- QUICK START v2.4 -->
      <div class="card">
        <h2>üìñ Quick Start (v2.4)</h2>
        <p style="color: #94a3b8; margin-bottom: 16px;">Production-ready E2EE with Signal Protocol + crypto-verified metrics.</p>
        
        <div class="api-key-box" style="background: #0f172a;">
          <pre style="margin: 0; color: #e2e8f0; font-size: 12px; overflow-x: auto; line-height: 1.5;"><code>import { createApp } from '@stvor/sdk';
import { RedisReplayCache } from './adapters';

const app = await createApp({
  appToken: '<span id="code-token" style="color: #3b82f6;">YOUR_API_KEY</span>',
  relayUrl: 'http://localhost:3002',
  storageAdapters: {
    replay: new RedisReplayCache(),
    sessions: postgresSessionStore,
    tofu: postgresTofuStore,
    identity: keystoreIdentity
  },
  productionMode: true  // Required!
});

const user = await app.connect('user@example.com');
await user.send('peer@example.com', 'E2EE! üîê');</code></pre>
        </div>
        
        <a href="/" class="btn btn-secondary" style="margin-top: 8px;">
          View Full Documentation ‚Üí
        </a>
      </div>
      
    </main>
  </div>
  
  <!-- CREATE PROJECT MODAL -->
  <div class="modal-overlay" id="modal">
    <div class="modal">
      <h2>Create New Project</h2>
      <input type="text" class="modal-input" id="project-name" placeholder="Project name (e.g., my-chat-app)">
      <div class="modal-actions">
        <button class="btn btn-secondary" onclick="closeModal()">Cancel</button>
        <button class="btn btn-primary" onclick="createProject()">Create Project</button>
      </div>
    </div>
  </div>
  
  <!-- NEW KEY MODAL -->
  <div class="modal-overlay" id="key-modal">
    <div class="modal">
      <h2>üéâ Project Created!</h2>
      <p style="color: #94a3b8; margin-bottom: 16px;">Copy your API key now. You won't be able to see it again.</p>
      
      <div class="api-key-box">
        <span class="api-key-value" id="new-key-value">stvor_xxxxxxxxxxxxxxxx</span>
        <button class="copy-btn" onclick="copyNewKey()">Copy</button>
      </div>
      
      <div class="modal-actions" style="margin-top: 24px;">
        <button class="btn btn-primary" onclick="closeKeyModal()">Done</button>
      </div>
    </div>
  </div>

  <script>
    /**
     * STVOR v2.4.0 Dashboard - Backend-Verified Metrics Only
     * 
     * ‚ö†Ô∏è  CRITICAL SECURITY MODEL:
     * 
     * THIS DASHBOARD:
     * - ONLY reads verified metrics from /api/metrics
     * - NEVER verifies cryptography (backend does that)
     * - NEVER calculates or generates metrics
     * - NEVER uses localStorage for metric values
     * - NEVER displays unverified data
     * 
     * WHAT DASHBOARD NEVER DOES:
     * ‚ùå Verify HMAC in browser (untrusted)
     * ‚ùå Generate numbers (demo / fallback)
     * ‚ùå Cache metrics locally
     * ‚ùå Show metrics without backend verification
     */

    // State: Only API projects (local storage OK for settings only)
    let projects = JSON.parse(localStorage.getItem('stvor_projects') || '[]');
    
    // Save to localStorage
    function saveProjects() {
      localStorage.setItem('stvor_projects', JSON.stringify(projects));
    }

    // Render projects
    function renderProjects() {
      const container = document.getElementById('projects-list');
      
      if (projects.length === 0) {
        container.innerHTML = `
          <div style="text-align: center; padding: 32px; color: #64748b;">
            <div style="font-size: 48px; margin-bottom: 16px;">üîê</div>
            <div>No projects yet. Create one to get started!</div>
          </div>
        `;
        return;
      }

      container.innerHTML = projects.map((project, index) => `
        <div class="project-item">
          <div>
            <div class="project-name">${project.name}</div>
            <div class="project-created">Created ${new Date(project.created).toLocaleDateString()}</div>
          </div>
          <div style="display: flex; align-items: center; gap: 12px;">
            <div class="api-key-box" style="margin: 0; padding: 8px 12px;">
              <span class="api-key-value api-key-hidden">${project.key.slice(0, 12)}‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢</span>
              <button class="copy-btn" onclick="copyKey('${project.key}', this)">Copy</button>
            </div>
            <button class="btn btn-danger" onclick="revokeKey(${index})" style="padding: 8px 12px;">Revoke</button>
          </div>
        </div>
      `).join('');

      if (projects.length > 0) {
        document.getElementById('code-token').textContent = projects[0].key;
      }
    }

    /**
     * Fetch verified metrics from backend
     * 
     * CRITICAL: Dashboard ONLY shows metrics that backend has verified:
     * - ‚úÖ Backend verified the cryptographic proof
     * - ‚úÖ Backend checked monotonicity
     * - ‚úÖ Backend prevented replay attacks
     * - ‚úÖ Backend stored metrics in DB
     * 
     * If backend says "no verified metrics" ‚Üí show empty state
     * If backend says "verified" ‚Üí display the numbers
     * 
     * Dashboard CANNOT OVERRIDE backend decisions
     */
    async function fetchAndDisplayMetrics() {
      const projectId = document.getElementById('current-project-id')?.value;
      if (!projectId) {
        showNoVerifiedActivity();
        return;
      }

      try {
        const response = await fetch(`/api/metrics?projectId=${projectId}`, {
          headers: {
            'Authorization': `Bearer ${getAuthToken()}`,
          },
        });

        if (!response.ok) {
          showMetricsError(`Backend error: ${response.status}`);
          return;
        }

        const data = await response.json();

        if (data.status === 'no_verified_activity' || !data.metrics) {
          showNoVerifiedActivity();
          return;
        }

        if (data.status === 'verified') {
          displayVerifiedMetrics(data.metrics, data.timestamp);
          return;
        }

        showMetricsError('Unknown response from backend');
      } catch (error) {
        console.error('[Dashboard] Failed to fetch metrics:', error);
        showMetricsError('Failed to fetch metrics from backend');
      }
    }

    /**
     * Display metrics that backend has already verified
     * 
     * We TRUST backend verification because:
     * - Backend verified cryptographic proof
     * - Backend is the source of truth
     * - Dashboard is just displaying
     */
    function displayVerifiedMetrics(metrics, timestamp) {
      const messagesStatCard = document.getElementById('messages-stat');
      
      const metricsHTML = `
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 12px;">
          <div style="background: #0f172a; border: 1px solid #334155; border-radius: 8px; padding: 12px; text-align: center;">
            <div style="font-size: 12px; color: #94a3b8; margin-bottom: 8px;">‚úÖ Encrypted</div>
            <div style="font-size: 24px; font-weight: 700; color: #10b981;">${metrics.messagesEncrypted}</div>
          </div>
          <div style="background: #0f172a; border: 1px solid #334155; border-radius: 8px; padding: 12px; text-align: center;">
            <div style="font-size: 12px; color: #94a3b8; margin-bottom: 8px;">‚úÖ Decrypted</div>
            <div style="font-size: 24px; font-weight: 700; color: #10b981;">${metrics.messagesDecrypted}</div>
          </div>
          <div style="background: #0f172a; border: 1px solid #334155; border-radius: 8px; padding: 12px; text-align: center;">
            <div style="font-size: 12px; color: #94a3b8; margin-bottom: 8px;">‚ùå Rejected</div>
            <div style="font-size: 24px; font-weight: 700; color: #ef4444;">${metrics.messagesRejected}</div>
          </div>
          <div style="background: #0f172a; border: 1px solid #334155; border-radius: 8px; padding: 12px; text-align: center;">
            <div style="font-size: 12px; color: #94a3b8; margin-bottom: 8px;">üîÑ Replay Attempts</div>
            <div style="font-size: 24px; font-weight: 700; color: #f59e0b;">${metrics.replayAttempts}</div>
          </div>
          <div style="background: #0f172a; border: 1px solid #334155; border-radius: 8px; padding: 12px; text-align: center;">
            <div style="font-size: 12px; color: #94a3b8; margin-bottom: 8px;">üõ°Ô∏è Auth Failures</div>
            <div style="font-size: 24px; font-weight: 700; color: #ef4444;">${metrics.authFailures}</div>
          </div>
          <div style="background: #0f172a; border: 1px solid #334155; border-radius: 8px; padding: 12px; text-align: center;">
            <div style="font-size: 12px; color: #94a3b8; margin-bottom: 8px;">‚è±Ô∏è Verified At</div>
            <div style="font-size: 14px; font-weight: 600; color: #60a5fa;">${new Date(timestamp).toLocaleString()}</div>
          </div>
        </div>
        <div style="margin-top: 12px; padding: 12px; background: #10b98130; border: 1px solid #10b981; border-radius: 8px; color: #10b981; font-size: 12px; text-align: center;">
          ‚úÖ Verified by backend
        </div>
      `;

      messagesStatCard.innerHTML = metricsHTML;
    }

    function showNoVerifiedActivity() {
      const messagesStatCard = document.getElementById('messages-stat');
      messagesStatCard.innerHTML = `
        <div style="padding: 24px; text-align: center; color: #64748b;">
          <div style="font-size: 48px; margin-bottom: 12px;">üìä</div>
          <div style="font-weight: 600;">No Verified E2EE Activity</div>
          <div style="font-size: 12px; margin-top: 8px; max-width: 400px;">
            Metrics will appear here once SDK transmits attestations and backend verifies them.
            This ensures only real, cryptographically-proven E2EE activity is displayed.
          </div>
        </div>
      `;
    }

    function showMetricsError(message) {
      const messagesStatCard = document.getElementById('messages-stat');
      messagesStatCard.innerHTML = `
        <div style="padding: 24px; text-align: center; color: #ef4444;">
          <div style="font-size: 48px; margin-bottom: 12px;">‚ö†Ô∏è</div>
          <div style="font-weight: 600;">Metrics Unavailable</div>
          <div style="font-size: 12px; margin-top: 8px; color: #94a3b8;">${message}</div>
        </div>
      `;
    }

    function getAuthToken() {
      // In production: get from session / OAuth token
      return localStorage.getItem('auth_token') || '';
    }

    // Modal controls
    function openModal() {
      if (projects.length >= 3) {
        alert('Free plan allows maximum 3 projects. Upgrade to Pro for more!');
        return;
      }
      document.getElementById('modal').classList.add('active');
      document.getElementById('project-name').focus();
    }

    function closeModal() {
      document.getElementById('modal').classList.remove('active');
      document.getElementById('project-name').value = '';
    }

    function closeKeyModal() {
      document.getElementById('key-modal').classList.remove('active');
    }

    // Generate API key
    function generateApiKey() {
      const chars = 'abcdefghijklmnopqrstuvwxyz0123456789';
      let key = 'stvor_';
      for (let i = 0; i < 24; i++) {
        key += chars.charAt(Math.floor(Math.random() * chars.length));
      }
      return key;
    }

    // Create project
    function createProject() {
      const name = document.getElementById('project-name').value.trim();
      if (!name) {
        alert('Please enter a project name');
        return;
      }

      const key = generateApiKey();
      projects.push({
        name,
        key,
        created: new Date().toISOString()
      });

      saveProjects();
      renderProjects();
      closeModal();

      document.getElementById('new-key-value').textContent = key;
      document.getElementById('key-modal').classList.add('active');
    }

    // Copy key
    function copyKey(key, btn) {
      navigator.clipboard.writeText(key).then(() => {
        btn.textContent = '‚úì Copied!';
        btn.classList.add('copied');
        setTimeout(() => {
          btn.textContent = 'Copy';
          btn.classList.remove('copied');
        }, 2000);
      });
    }

    function copyNewKey() {
      const key = document.getElementById('new-key-value').textContent;
      const btn = document.querySelector('#key-modal .copy-btn');
      copyKey(key, btn);
    }

    // Revoke key
    function revokeKey(index) {
      if (confirm('Are you sure you want to revoke this API key? This cannot be undone.')) {
        projects.splice(index, 1);
        saveProjects();
        renderProjects();
      }
    }

    // Close modal on overlay click
    document.querySelectorAll('.modal-overlay').forEach(overlay => {
      overlay.addEventListener('click', (e) => {
        if (e.target === overlay) {
          overlay.classList.remove('active');
        }
      });
    });

    // Enter key to submit
    document.getElementById('project-name').addEventListener('keydown', (e) => {
      if (e.key === 'Enter') createProject();
    });

    // Relay health check
    async function checkRelayHealth() {
      const dot = document.getElementById('relay-status-dot');
      const text = document.getElementById('relay-status-text');
      const card = document.getElementById('relay-status-card');

      try {
        const response = await fetch('http://localhost:3002/health', { 
          method: 'GET',
          signal: AbortSignal.timeout(3000)
        }).catch(() => null);

        if (response && response.ok) {
          dot.style.background = '#10b981';
          text.textContent = 'Relay reachable';
          text.style.color = '#10b981';
          card.style.borderColor = '#059669';
        } else {
          dot.style.background = '#64748b';
          text.textContent = 'Unknown';
          text.style.color = '#94a3b8';
          card.style.borderColor = '#475569';
        }
      } catch (e) {
        dot.style.background = '#64748b';
        text.textContent = 'Unknown';
        text.style.color = '#94a3b8';
        card.style.borderColor = '#475569';
      }
    }

    // Initialize
    renderProjects();
    showNoVerifiedActivity();
    checkRelayHealth();

    // Recheck every 30s
    setInterval(checkRelayHealth, 30000);

    // Export for SDK to call
    window.stvorDashboard = {
      updateMetrics: updateStatsWithVerifiedMetrics,
      showNoActivity: showNoVerifiedActivity
    };
  </script>
</body>
</html>
